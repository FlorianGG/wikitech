{# src/WKT/UserBundle/Resources/views/User/user.html.twig #}

{# On étend notre layout #}
{% extends "WKTCoreBundle:Core:layout.html.twig" %}

{% block body %}
<div class="row	table-responsive">
	<table id="datatable" class="table table-hover table-condensed">
	    <thead>
			<tr>
				<th >Pseudo</th>
				<th >Prénom</th>
				<th >Nom</th>
				<th >Email</th>
				<th >User activé</th>
				<th >Points de contribution</th>
				<th >Indice de confiance</th>
				<th >Rôle</th>
				<th >Actions</th>
			</tr>
	    </thead>
	    <tbody>
	    	{% for user in users %}
	    		{% if user != app.user %}
		    	    <tr {% if user.enabled == 0 %} class="danger" {% endif %}>
		    	    	<td>{{user.username}}</td>
		    	    	<td>{{user.firstname}}</td>
		    	    	<td>{{user.lastname}}</td>
		    	    	<td>{{user.email}}</td>
		    	    	<td>
							{% if user.enabled == 0 %}
								non
							{% else %}
							 	oui
							{% endif %}
		    	    	</td>
		    	    	<td>{{user.nbPoint}}</td>
		    	    	<td>
		    	    		{% if confidenceScores[user.username] == 'first' and user.enabled == 1 %}
		    	    		  <small>Aucune contribution</small>
		    	    		{% elseif confidenceScores[user.username] == 'waiting' and user.enabled == 1 %} 
		    	    		  <small>Toutes les contributions sont en attentes</small>
		    	    		{% elseif user.enabled == 0 %}
		    	    		-
		    	    		{% else %}
		    	    		  {{confidenceScores[user.username]|number_format(2)}}% 
		    	    		{% endif %}
		    	    	</td>
						<td>
							{% if 'ROLE_ADMIN' in user.roles %}
								Administrateur
							{% else %}
								Utilisateur
						    {% endif %}
						</td>
		    	    	<td>
							{% if 'ROLE_ADMIN' in user.roles %}
								<a href="{{path('wkt_user_demote', {'id': user.id})}}" class="btn btn-xs btn-warning">Rétrograder</a>
							{% else %}
								<a href="{{path('wkt_user_promote', {'id': user.id})}}" class="btn btn-xs btn-success">Promouvoir</a>
						    {% endif %}
							{% if user.enabled == 0 %}
								<a href="{{path('wkt_user_enabled', {'id': user.id, 'activate':1})}}" class="btn btn-xs btn-primary">Activer</a>
							{% else %}
								<a href="{{path('wkt_user_enabled', {'id': user.id, 'activate':0})}}" class="btn btn-xs btn-danger">Désactiver</a>
						    {% endif %}
							<a href="{{path('wkt_user_view_profile', {'id': user.id})}}" class="btn btn-xs btn-info">Profil</a>
		    	    	</td>
		    	    </tr>
	    		{% endif %}
	    	{% endfor %}
	    </tbody>
	    <tfoot>
			<tr>
				<td>Pseudo</td>
				<td>Prénom</td>
				<td>Nom</td>
				<td>Utilisateur activé</td>
				<td>Email</td>
				<td>Points de contribution</td>
				<td>Indice de confiance</td>
				<td>Rôle</td>
			</tr>
	    </tfoot>
	</table>
</div>
{% endblock %}
{% block javascripts %}
  {{parent()}}
  <script src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js" type="text/javascript"></script>
  {% javascripts 'bundles/wktplatform/datatable.js'%} 
    <script type="text/javascript" src="{{ asset_url }}"></script>
  {% endjavascripts %}
{% endblock %}
