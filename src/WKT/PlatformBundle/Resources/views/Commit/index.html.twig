{# src/WKT/PlatformBundle/Resources/views/Commit/index.html.twig #}

{% extends 'WKTCoreBundle:Core:layout.html.twig' %}
{% block stylesheets %}
  {{parent()}}
  
{% endblock %}

{% block body %}
    {% set testArticleModified = [] %}
    <h2>Liste des modifications existantes</h2>
    <div class="table-responsive">
        <table id="datatable" class="table table-striped table-condensed">
            <thead>
            {% if commits is empty %}
                <strong><em>Aucune modification n'a encore √©t√© enregistr√©e </em>ü§ì</strong>
            {% else %}
                <tr>
                    <th>Formation</th>
                    <th>Titre de l'article</th>
                    <th>Date cr√©ation</th>
                    <th>Auteur</th>
                    <th>Indice de confiance</th>
                    <th>Type de modification</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for commit in commits %}
                      <tr>
                          <td>{{commit.articleModified.part.training.title}}</td>
                          <td>{{commit.articleModified.title}}</td>
                          <td>{{commit.articleModified.createdAt|date('d/m/Y')}}</td>
                          <td>
                            {% if commit.user is empty %}
                              Un utilisateur anonyme 
                            {% else %}
                              {{commit.user.username}}
                            {% endif %}
                          </td>
                          <td class="text-center">
                            {% if commit.user is empty %}
                            -
                            {% else %}
                              {% if confidenceScores[commit.user.username] == 'first' %}
                                <small>Premi√®re contribution</small>
                              {% elseif confidenceScores[commit.user.username] == 'waiting' %} 
                                <small>Toutes les contributions sont en attentes</small>
                              {% else %}
                                {{confidenceScores[commit.user.username]|number_format(2)}}% 
                              {% endif %}
                            {% endif %}
                            
                          </td>
                          <td>{{commit.typeOfModification.type}}</td>
                          <td>
                            <a class="btn btn-success btn-xs" href="{{path('wkt_platform_article_modified_validation', {'id': commit.articleModified.id})}}" >Voir</a>
                           <a class="btn btn-danger btn-xs" href="{{path('wkt_platform_article_modified_rejection', {'id': commit.articleModified.id, 'strike': 0})}}">Rejeter la contribution</a>
                          </td>
                      </tr> 
                {% endfor %}
            </tbody>
            <tfoot>
                <tr>
                  <th>Formation</th>
                  <th>Titre de l'article</th>
                  <th>Date cr√©ation</th>
                  <th>Auteur</th>
                  <th>Indice de confiance</th>
                  <th>Type de modification</th>
                  <th>Action</th>
                </tr>
            </tfoot>
            {% endif %}
        </table>
    </div>       
{% endblock %}
{% block javascripts %}
    {{parent()}}
    <script src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js" type="text/javascript"></script>
    {% javascripts 'bundles/wktplatform/datatable.js'%} 
      <script type="text/javascript" src="{{ asset_url }}"></script>
    {% endjavascripts %}
{% endblock %}

